<html>
<head>
  <title>Manage Your Ledes</title>
  <link href='http://fonts.googleapis.com/css?family=Andada' rel='stylesheet' type='text/css'>
  <link href='/stylesheets/main.css' media='all' rel='stylesheet' type='text/css'>
  <link rel="icon" type="image/png" href="/images/lede_icon.png">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
  <script src="/javascripts/api.js"></script> 
  <script type="text/javascript" src="/bookmarklet/bookmarklet-generator.js"></script>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-36275380-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script type='text/javascript'>
    $(function() {

      function logout() {
        $.ajax('/api/user/logout', {
          type: 'POST',
          success: function() {
            window.location.href = '/';
          }
        });
      }

      function generateBookmarklet() {
        api.user.apikey({}, function(result) {
          $('#generate-bookmarklet-button').hide();
          var e = createBookmarkletLink(result.result);
          $('#bookmarklet-div').append("Drag this link to your browser's bookmark bar: ");
          $('#bookmarklet-div').append(e);
        },
        function(err) {
          console.log(err);
        });

      }

/*
      function updateLedesList() {
        api.lede.list(function(res) {
          var html = "";
          $.each(res.ledes, function(index, row) {
            html += "<tr>";
            html += "<td><a href='" + row.uri + "'>" + (row.title ? row.title : row.uri) + "</a></td>";
            html += "<td>" + row.created_at + "</td>";
            html += "<td><a href='#' onclick=\"alert('not implemented');\">Stop Leding</a></td>";
            html += "</tr>";
          });

          $('#ledes-list tbody').html(html);
        },
        function(err) {
          $('#error').html(err.error);
        });
      }
*/
      // handlers for form

      $('a#logout-button').click(function(evt) {
        logout();
        evt.preventDefault();
      });

      $('a#list').click(function(evt) {
        updateLedesList();
        evt.preventDefault();
      });

      $('#generate-bookmarklet-button').click(function(evt) {
        generateBookmarklet();
        evt.preventDefault();
      });
    });
  </script>
</head>
<body>
  <h2>User Management Panel</h2>
  <a href='#' id='logout-button' class='button'> Log Out </a><br/>

  <div id='error' class='message'></div>

  <h3>Need a new bookmarklet?</h3>
  <div id='bookmarklet-div'>
    <a href='#' id='generate-bookmarklet-button' class='button'> Generate Bookmarklet </a>
  </div>

<!--
  <table id='ledes-list'>
    <thead>
      <tr>
        <th>Lede</th>
        <th>Created</th>
        <th>Actions</th>
      </tr>
    <tbody>
    </tbody>
  </table>
-->

</body>
</html>
